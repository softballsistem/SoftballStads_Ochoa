import{r as x,j as e,e as w,d as N}from"./index-XrI2zrrk.js";import{u as T,a as b,P as S,M as C}from"./Modal-CeGRT8Ut.js";import{t as u}from"./api-blwJs40V.js";import{u as k,T as E}from"./index.esm-F0xEuqth.js";import{a as F,T as L}from"./TeamLogo-BNPt6Yn-.js";import{P as U}from"./pen-D1KfaHhJ.js";import"./clsx-B-dksMZM.js";import"./alert-circle-9YMSBzYO.js";function q({team:r,onSubmit:n,onCancel:h}){const[i,c]=x.useState(!1),[t,o]=x.useState((r==null?void 0:r.logo_url)||null),{register:a,handleSubmit:g,formState:{errors:d}}=k({defaultValues:{name:(r==null?void 0:r.name)||"",coach:(r==null?void 0:r.coach)||"",season:(r==null?void 0:r.season)||"2024"}}),f=async l=>{c(!0);try{await n({...l,logo_url:t})}finally{c(!1)}},p=l=>{o(l)};return e.jsxs("form",{onSubmit:g(f),className:"space-y-6",children:[r&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Logo del Equipo"}),e.jsx(F,{teamId:r.id,currentLogoUrl:t,onLogoUpdate:p})]}),e.jsx("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700",children:"Team Name *"}),e.jsx("input",{...a("name",{required:"Team name is required"}),type:"text",className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-green-500 focus:border-green-500",placeholder:"Enter team name"}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"coach",className:"block text-sm font-medium text-gray-700",children:"Coach"}),e.jsx("input",{...a("coach"),type:"text",className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-green-500 focus:border-green-500",placeholder:"Enter coach name"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"season",className:"block text-sm font-medium text-gray-700",children:"Season"}),e.jsx("input",{...a("season",{required:"Season is required"}),type:"text",className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-green-500 focus:border-green-500",placeholder:"e.g., 2024"}),d.season&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:d.season.message})]}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[e.jsx("button",{type:"button",onClick:h,className:"px-4 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 transition-colors",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:i,className:"px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-green-600 hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 disabled:opacity-50 transition-colors",children:i?"Saving...":r?"Update Team":"Create Team"})]})]})}const M=async()=>u.getAll();function O(){const r=w(),{data:n,isLoading:h,error:i}=T("teams",M),[c,t]=x.useState(!1),[o,a]=x.useState(null),g=b(u.create,{onSuccess:()=>{r.invalidateQueries("teams"),t(!1)}}),d=b(s=>u.update(s.id,s.teamData),{onSuccess:()=>{r.invalidateQueries("teams"),t(!1),a(null)}}),f=b(u.delete,{onSuccess:()=>{r.invalidateQueries("teams")}}),p=async s=>{o?d.mutate({id:o.id,teamData:s}):g.mutate(s)},l=s=>{a(s),t(!0)},v=async s=>{window.confirm("Are you sure you want to delete this team? This will also delete all associated players and statistics.")&&f.mutate(s)},y=()=>{t(!1),a(null)};return h?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-green-600"})}):i?e.jsx("div",{children:"Error loading data"}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Teams"}),e.jsxs("button",{onClick:()=>t(!0),className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-green-600 hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 transition-colors",children:[e.jsx(S,{className:"h-4 w-4 mr-2"}),"Add Team"]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:n==null?void 0:n.map(s=>{var j;return e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(L,{logoUrl:s.logo_url,teamName:s.name,size:"large",className:"mr-3"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:s.name}),e.jsxs("p",{className:"text-sm text-gray-600",children:["Season: ",s.season]})]})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{onClick:()=>l(s),className:"p-2 text-gray-400 hover:text-blue-600 transition-colors",children:e.jsx(U,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>v(s.id),className:"p-2 text-gray-400 hover:text-red-600 transition-colors",children:e.jsx(E,{className:"h-4 w-4"})})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center text-sm text-gray-600",children:[e.jsx(N,{className:"h-4 w-4 mr-2"}),e.jsxs("span",{children:["Coach: ",s.coach||"Not assigned"]})]}),e.jsxs("div",{className:"flex items-center text-sm text-gray-600",children:[e.jsx(N,{className:"h-4 w-4 mr-2"}),e.jsxs("span",{children:["Players: ",((j=s.players)==null?void 0:j.length)||0]})]})]}),s.players&&s.players.length>0&&e.jsxs("div",{className:"mt-4 pt-4 border-t border-gray-200",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-900 mb-2",children:"Recent Players"}),e.jsxs("div",{className:"space-y-1",children:[s.players.slice(0,3).map(m=>e.jsxs("div",{className:"text-xs text-gray-600",children:["#",m.jersey_number||"00"," ",m.name," - ",m.position]},m.id)),s.players.length>3&&e.jsxs("div",{className:"text-xs text-gray-500",children:["+",s.players.length-3," more players"]})]})]})]},s.id)})}),e.jsx(C,{isOpen:c,onClose:y,title:o?"Edit Team":"Add New Team",children:e.jsx(q,{team:o,onSubmit:p,onCancel:y})})]})}export{O as default};
