import{r as m,j as e,e as C,f as T,U as A}from"./index-BxGlouXT.js";import{u as F,a as y,P as w,M}from"./Modal-BGuIe542.js";import{c as E,p as h,t as B}from"./api-CPHYY_DM.js";import{u as L,T as R}from"./index.esm-DypWtb6H.js";import{C as D}from"./credit-card-DYChI4QY.js";import"./clsx-B-dksMZM.js";function Q({player:t,teams:a,onSubmit:f,onCancel:g}){const[u,o]=m.useState(!1),{register:n,handleSubmit:c,formState:{errors:i}}=L({defaultValues:{name:(t==null?void 0:t.name)||"",jersey_number:(t==null?void 0:t.jersey_number)||null,position:(t==null?void 0:t.position)||"Utility",team_id:(t==null?void 0:t.team_id)||"",date_of_birth:(t==null?void 0:t.date_of_birth)||""}}),p=async r=>{o(!0);try{const b={...r,jersey_number:r.jersey_number?parseInt(r.jersey_number):null,team_id:r.team_id||null,date_of_birth:r.date_of_birth||null};await f(b)}finally{o(!1)}},l=["Pitcher","Catcher","1st Base","2nd Base","3rd Base","Shortstop","Left Field","Center Field","Right Field","Utility"];return e.jsxs("form",{onSubmit:c(p),className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700",children:"Player Name *"}),e.jsx("input",{...n("name",{required:"Player name is required"}),type:"text",className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-green-500 focus:border-green-500",placeholder:"Enter player name"}),i.name&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:i.name.message})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"jersey_number",className:"block text-sm font-medium text-gray-700",children:"Jersey Number"}),e.jsx("input",{...n("jersey_number",{min:{value:0,message:"Jersey number must be positive"},max:{value:99,message:"Jersey number must be 99 or less"}}),type:"number",className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-green-500 focus:border-green-500",placeholder:"e.g., 42",min:"0",max:"99"}),i.jersey_number&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:i.jersey_number.message})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"position",className:"block text-sm font-medium text-gray-700",children:"Position"}),e.jsx("select",{...n("position"),className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-green-500 focus:border-green-500",children:l.map(r=>e.jsx("option",{value:r,children:r},r))})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"team_id",className:"block text-sm font-medium text-gray-700",children:"Team"}),e.jsxs("select",{...n("team_id"),className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-green-500 focus:border-green-500",children:[e.jsx("option",{value:"",children:"No Team"}),a.map(r=>e.jsx("option",{value:r.id,children:r.name},r.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"date_of_birth",className:"block text-sm font-medium text-gray-700",children:"Date of Birth"}),e.jsx("input",{...n("date_of_birth"),type:"date",className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-green-500 focus:border-green-500"})]}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[e.jsx("button",{type:"button",onClick:g,className:"px-4 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 transition-colors",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:u,className:"px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-green-600 hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 disabled:opacity-50 transition-colors",children:u?"Saving...":t?"Update Player":"Create Player"})]})]})}const U=async()=>{const[t,a]=await Promise.all([h.getAll(),B.getAll()]);return{players:t.players,teams:a}};function O(){const t=C(),{data:a,isLoading:f,error:g}=F("playersAndTeams",U),[u,o]=m.useState(!1),[n,c]=m.useState(null),[i,p]=m.useState(""),[l,r]=m.useState(""),b=y(h.create,{onSuccess:()=>{t.invalidateQueries("playersAndTeams"),o(!1)}}),v=y(s=>h.update(s.id,s.playerData),{onSuccess:()=>{t.invalidateQueries("playersAndTeams"),o(!1),c(null)}}),_=y(h.delete,{onSuccess:()=>{t.invalidateQueries("playersAndTeams")}}),P=async s=>{n?v.mutate({id:n.id,playerData:s}):b.mutate(s)},k=s=>{c(s),o(!0)},S=async s=>{window.confirm("Are you sure you want to delete this player? This will also delete all associated statistics.")&&_.mutate(s)},j=()=>{o(!1),c(null)},N=T.useMemo(()=>a?a.players.filter(s=>{const d=s.name.toLowerCase().includes(i.toLowerCase()),x=!l||s.team_id===l;return d&&x}):[],[a,i,l]);return f?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-green-600"})}):g?e.jsx("div",{children:"Error loading data"}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Players"}),e.jsxs("button",{onClick:()=>o(!0),className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-green-600 hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 transition-colors",children:[e.jsx(w,{className:"h-4 w-4 mr-2"}),"Add Player"]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[e.jsx("div",{className:"flex-1",children:e.jsx("input",{type:"text",placeholder:"Search players...",value:i,onChange:s=>p(s.target.value),className:"block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-green-500 focus:border-green-500"})}),e.jsx("div",{className:"sm:w-48",children:e.jsxs("select",{value:l,onChange:s=>r(s.target.value),className:"block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-green-500 focus:border-green-500",children:[e.jsx("option",{value:"",children:"All Teams"}),a==null?void 0:a.teams.map(s=>e.jsx("option",{value:s.id,children:s.name},s.id))]})})]}),N.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(A,{className:"mx-auto h-12 w-12 text-gray-400"}),e.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"No players found"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:i||l?"Try adjusting your filters.":"Get started by adding a new player."}),!i&&!l&&e.jsx("div",{className:"mt-6",children:e.jsxs("button",{onClick:()=>o(!0),className:"inline-flex items-center px-4 py-2 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-green-600 hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500",children:[e.jsx(w,{className:"h-4 w-4 mr-2"}),"Add Player"]})})]}):e.jsx("div",{className:"bg-white shadow-sm border border-gray-200 rounded-lg overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Player"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Team"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Position"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Stats"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"AVG"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:N.map(s=>{var x;const d=E(s.player_stats||[]);return e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0 h-10 w-10",children:e.jsx("div",{className:"h-10 w-10 rounded-full bg-green-100 flex items-center justify-center",children:e.jsxs("span",{className:"text-sm font-medium text-green-800",children:["#",s.jersey_number||"00"]})})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:s.name}),s.date_of_birth&&e.jsxs("div",{className:"text-sm text-gray-500",children:["Born: ",new Date(s.date_of_birth).toLocaleDateString()]})]})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:((x=s.teams)==null?void 0:x.name)||"No Team"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:s.position}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.jsxs("div",{className:"flex space-x-4",children:[e.jsxs("span",{children:["G: ",d.games]}),e.jsxs("span",{children:["H: ",d.hits]}),e.jsxs("span",{children:["R: ",d.runs]}),e.jsxs("span",{children:["RBI: ",d.rbi]})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:d.at_bats>0?`.${Math.round(d.avg*1e3)}`:".000"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:e.jsxs("div",{className:"flex justify-end space-x-2",children:[e.jsx("button",{onClick:()=>k(s),className:"text-blue-600 hover:text-blue-900 transition-colors",children:e.jsx(D,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>S(s.id),className:"text-red-600 hover:text-red-900 transition-colors",children:e.jsx(R,{className:"h-4 w-4"})})]})})]},s.id)})})]})})}),e.jsx(M,{isOpen:u,onClose:j,title:n?"Edit Player":"Add New Player",children:e.jsx(Q,{player:n,teams:(a==null?void 0:a.teams)||[],onSubmit:P,onCancel:j})})]})}export{O as default};
